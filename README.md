

# نود سفارشی n8n برای بات روبیکا (`n8n-nodes-rubika`)

این بسته، یک نود سفارشی برای پلتفرم اتوماسیون **n8n** است که به شما امکان می‌دهد با API بات‌های روبیکا به سادگی تعامل داشته باشید. با استفاده از این نود می‌توانید گردش‌کارهای (Workflows) قدرتمندی برای ارسال و مدیریت پیام‌ها در روبیکا بسازید.

## ✨ ویژگی‌های کلیدی

  - **نصب آسان**: به راحتی از طریق Community Nodes در n8n نصب کنید.
  - **پشتیبانی از عملیات‌های مختلف**: ارسال و ویرایش پیام، ارسال فایل (تصویر، ویدئو، صدا، سند)، دریافت اطلاعات بات و فایل.
  - **احراز هویت امن**: مدیریت توکن بات شما به صورت امن از طریق بخش Credentials در n8n.
  - **ادغام‌پذیری**: قابلیت اتصال به صدها سرویس دیگر از طریق n8n برای ساخت اتوماسیون‌های پیچیده.

## 🚀 شروع سریع

برای استفاده از این نود، مراحل زیر را دنبال کنید.

### ۱. پیش‌نیازها

  - یک حساب کاربری فعال در n8n (نسخه ابری یا خود-میزبان).
  - حساب کاربری در پیام‌رسان روبیکا.

### ۲. نصب

دو روش برای نصب این بسته وجود دارد:

#### روش اول: نصب از طریق Community Nodes (پیشنهادی)

1.  در پنل n8n، به بخش **Settings \> Community Nodes** بروید.
2.  روی **Install** کلیک کنید.
3.  در کادر جستجو، عبارت `n8n-nodes-rubika-bot` را وارد کرده و **Install** را بزنید.
4.  پس از نصب موفق، n8n را مجدداً راه‌اندازی (Restart) کنید تا نود در لیست نودها ظاهر شود.

#### روش دوم: نصب دستی (برای کاربران حرفه‌ای)

اگر n8n را به صورت خود-میزبان (Self-hosted) نصب کرده‌اید، می‌توانید از طریق دستور زیر در ترمینال و در پوشه اصلی n8n، بسته را نصب کنید:

```bash
npm install n8n-nodes-rubika
```

فراموش نکنید که پس از نصب، سرویس n8n را ریستارت کنید.

### ۳. راه‌اندازی اولیه

#### گام اول: ساخت بات در روبیکا

1.  در اپلیکیشن روبیکا، به ربات رسمی `@BotFather` پیام دهید.
2.  دستور `/newbot` را ارسال کنید.
3.  یک **نام** (Name) و یک **نام کاربری** (Username) برای بات خود انتخاب کنید.
4.  پس از ساخت موفق بات، **توکن (Token)** مخصوص آن برای شما ارسال می‌شود. این توکن را کپی و در جایی امن نگهداری کنید.

#### گام دوم: تنظیم Credentials در n8n

برای اینکه n8n بتواند به بات شما متصل شود، باید توکن را به آن معرفی کنید.

1.  در پنل n8n، به بخش **Credentials** بروید و روی **Add credential** کلیک کنید.
2.  در لیست باز شده، **Rubika Bot API** را پیدا و انتخاب کنید.
3.  یک نام دلخواه برای این Credential انتخاب کنید.
4.  توکنی که از `@BotFather` دریافت کردید را در فیلد `Token` وارد کنید.
5.  روی **Test** کلیک کنید تا از صحت اتصال اطمینان حاصل کنید و سپس **Save** را بزنید.

## 🛠️ راهنمای استفاده

پس از نصب و تنظیم، می‌توانید از نود **Rubika Bot** در گردش‌کارهای خود استفاده کنید.

### عملیات‌های موجود (Operations)

این نود عملیات‌های متنوعی را برای تعامل با API روبیکا فراهم می‌کند:

#### ارسال محتوا

  - **Send Message**: ارسال یک پیام متنی ساده.
  - **Send Photo**: ارسال تصویر همراه با کپشن (اختیاری).
  - **Send Audio**: ارسال فایل صوتی.
  - **Send Video**: ارسال فایل ویدئویی.
  - **Send Document**: ارسال هر نوع فایل به عنوان سند.
  - **Send Location**: ارسال مختصات جغرافیایی (طول و عرض).
  - **Send Contact**: ارسال اطلاعات یک مخاطب.

#### مدیریت پیام‌ها

  - **Edit Message**: ویرایش متن یک پیام ارسال شده.
  - **Delete Message**: حذف یک پیام از چت.

#### سایر عملیات‌ها

  - **Get Me**: دریافت اطلاعات مربوط به خود بات (مانند نام و نام کاربری).
  - **Get File**: دریافت اطلاعات و لینک دانلود یک فایل از طریق `file_id`.

### مثال کاربردی: ارسال گزارش روزانه به یک کانال

فرض کنید می‌خواهید هر روز ساعت ۹ صبح، یک پیام ثابت به کانال خود در روبیکا ارسال کنید.

1.  **Trigger Node**: یک نود **Cron** به گردش‌کار خود اضافه کنید و زمانبندی آن را روی `Every Day` و `Hour: 9` تنظیم کنید.
2.  **Rubika Bot Node**:
      - یک نود **Rubika Bot** را به خروجی نود Cron متصل کنید.
      - در بخش **Credential**، حسابی که در مراحل قبل ساختید را انتخاب کنید.
      - **Operation** را روی `Send Message` تنظیم کنید.
      - **Chat ID** را با آیدی کانال یا چت مورد نظر خود پر کنید (مثلاً `@YourChannelUsername` یا آیدی عددی).
      - در فیلد **Text**، پیام مورد نظر خود را بنویسید.
3.  گردش‌کار خود را فعال (Activate) کنید. از این پس، این پیام به صورت خودکار در زمان مشخص شده ارسال خواهد شد.

## 💡 نکات پیشرفته

شما می‌توانید از **Expressions** در n8n برای ارسال داده‌های داینامیک استفاده کنید. برای مثال، اگر داده‌ای از یک نود قبلی (مانند یک سرویس آب و هوا) دریافت می‌کنید، می‌توانید آن را به صورت زیر در متن پیام قرار دهید:

```
{{ $json.weather.description }}
```

## 🤝 مشارکت و گزارش خطا

این پروژه به صورت متن‌باز توسعه داده می‌شود. در صورت مشاهده هرگونه خطا یا داشتن پیشنهادی برای بهبود، لطفاً یک **Issue** در مخزن گیت‌هاب پروژه ثبت کنید. (در صورت وجود لینک گیت‌هاب، آن را اینجا قرار دهید)

## 📜 مجوز استفاده (License)

این پروژه تحت مجوز **MIT** منتشر شده است. استفاده از آن برای مقاصد شخصی و تجاری کاملاً آزاد است.
